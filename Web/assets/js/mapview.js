// Generated by CoffeeScript 1.3.3
(function() {
  var SetupMap, border, borderCoordinates, googleMap, imageBounds, incident, incidentList, mapCanvas, newark, newarkLat, newarkLng, oldmap, size, _i, _j, _len, _len1, _ref, _ref1,
    _this = this;

  SetupMap = function() {
    var elem, mapCenter, mapOptions;
    mapCenter = new google.maps.LatLng(-41.288889, 174.777222);
    mapOptions = {
      zoom: 9,
      center: mapCenter,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    elem = document.getElementById('map_canvas');
    return new google.maps.Map(elem, mapOptions);
  };

  googleMap = SetupMap();

  google.maps.event.addDomListener(window, "load", googleMap);

  mapCanvas = $("#map_canvas");

  mapCanvas.css({
    height: "100%"
  });

  newark = new google.maps.LatLng(40.740, -74.18);

  newarkLat = new google.maps.LatLng(40.716216, -74.213393);

  newarkLng = new google.maps.LatLng(40.765641, -74.139235);

  imageBounds = new google.maps.LatLngBounds(newarkLat, newarkLng);

  oldmap = new google.maps.GroundOverlay("http://placehold.it/480x360", imageBounds);

  google.maps.event.addListener(oldmap, 'click', function() {
    return Window.CreateIncidentModal(2);
  });

  oldmap.setMap(googleMap);

  incidentList = Window.IncidentList(0, 12);

  size = 0.05;

  _ref = incidentList.Incidents;
  for (_i = 0, _len = _ref.length; _i < _len; _i++) {
    incident = _ref[_i];
    newarkLat = new google.maps.LatLng(incident.Lat - size, incident.Lng - size * 2);
    newarkLng = new google.maps.LatLng(incident.Lat + size, incident.Lng + size * 2);
    imageBounds = new google.maps.LatLngBounds(newarkLat, newarkLng);
    oldmap = new google.maps.GroundOverlay("http://placehold.it/480x360", imageBounds);
    google.maps.event.addListener(oldmap, 'click', function() {
      return Window.CreateIncidentModal(incident.Incident_ID);
    });
    oldmap.setMap(googleMap);
  }

  _ref1 = incidentList.Incidents;
  for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
    incident = _ref1[_j];
    newarkLat = new google.maps.LatLng(incident.Lat - size, incident.Lng - size * 2);
    newarkLng = new google.maps.LatLng(incident.Lat + size, incident.Lng + size * 2);
    borderCoordinates = [new google.maps.LatLng(incident.Lat - size, incident.Lng - size * 2), new google.maps.LatLng(incident.Lat - size, incident.Lng + size * 2), new google.maps.LatLng(incident.Lat + size, incident.Lng + size * 2), new google.maps.LatLng(incident.Lat + size, incident.Lng - size * 2), new google.maps.LatLng(incident.Lat - size, incident.Lng - size * 2)];
    border = new google.maps.Polyline({
      path: borderCoordinates,
      strokeColor: "000000",
      strokeOpacity: 1,
      strokeWeight: 1
    });
    border.setMap(googleMap);
  }

}).call(this);
